---
external help file: ColorScripts-Enhanced-help.xml
Module Name: ColorScripts-Enhanced
online version: https://github.com/Nick2bad4u/ps-color-scripts-enhanced
schema: 2.0.0
---

# Set-ColorScriptConfiguration

## SYNOPSIS

Persist changes to the ColorScripts-Enhanced cache and startup configuration.

## SYNTAX

```
Set-ColorScriptConfiguration [-AutoShowOnImport <Boolean>] [-ProfileAutoShow <Boolean>] [-CachePath <String>] [-DefaultScript <String>] [-PassThru] [<CommonParameters>]
```

## DESCRIPTION

`Set-ColorScriptConfiguration` updates the module configuration file. You can relocate the cache directory, control whether the module auto-renders a colorscript on import, and set the default script used by `Add-ColorScriptProfile` or startup automation. Any directory supplied for `-CachePath` is created if it does not already exist. Supplying an empty string to `-CachePath` or `-DefaultScript` clears the stored value.

When `-PassThru` is used, the cmdlet returns the updated configuration (equivalent to calling `Get-ColorScriptConfiguration`).

## EXAMPLES

### EXAMPLE 1

```powershell
Set-ColorScriptConfiguration -CachePath 'D:/Temp/ColorScriptsCache' -AutoShowOnImport:$true -ProfileAutoShow:$false -DefaultScript 'bars'
```

Moves the cache to `D:/Temp/ColorScriptsCache`, enables automatic display on module import, disables profile auto-show, and sets `bars` as the default script.

### EXAMPLE 2

```powershell
Set-ColorScriptConfiguration -DefaultScript '' -PassThru
```

Clears the default script and returns the resulting configuration object.

## PARAMETERS

### -AutoShowOnImport

Enable or disable automatic rendering of a colorscript when the module is imported.

```yaml
Type: Boolean
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: (no change)
Accept pipeline input: False
Accept wildcard characters: False
```

### -CachePath

Override the cache directory. Supports relative paths, environment variables, and `~` expansion. When left blank or set to an empty string the cache path reverts to the platform default.

```yaml
Type: String
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: (no change)
Accept pipeline input: False
Accept wildcard characters: False
```

### -DefaultScript

Set or clear the script name used by profile helpers and auto-show features. Provide an empty string to remove the stored value.

```yaml
Type: String
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: (no change)
Accept pipeline input: False
Accept wildcard characters: False
```

### -PassThru

Return the updated configuration object instead of writing nothing.

```yaml
Type: SwitchParameter
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: False
Accept pipeline input: False
Accept wildcard characters: False
```

### -ProfileAutoShow

Control whether a profile snippet generated by `Add-ColorScriptProfile` includes an automatic `Show-ColorScript` call.

```yaml
Type: Boolean
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: (no change)
Accept pipeline input: False
Accept wildcard characters: False
```

### CommonParameters

This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, and -WarningAction. For more information, see [about_CommonParameters](http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### None

You cannot pipe input to this cmdlet.

## OUTPUTS

### System.Collections.Hashtable

Returned only when `-PassThru` is specified. The structure matches `Get-ColorScriptConfiguration`.

## NOTES

Configuration changes are persisted under the directory reported by `Get-ColorScriptConfiguration`. Environment variable `COLOR_SCRIPTS_ENHANCED_CONFIG_ROOT` can be used to relocate the settings file.

## RELATED LINKS

[Get-ColorScriptConfiguration](Get-ColorScriptConfiguration.md)
[Reset-ColorScriptConfiguration](Reset-ColorScriptConfiguration.md)
[Add-ColorScriptProfile](Add-ColorScriptProfile.md)
